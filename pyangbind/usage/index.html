<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>CLI Usage</title> <meta name="description" content="PyangBind adds a number of command-line options to Pyang:"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://pynms.io/pyangbind/usage"> <link rel="alternate" type="application/rss+xml" title="PyNMS" href="http://pynms.io/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Home</a></li> <li><a href="/about">About</a></li> <li><a href="/docs">Documentation Notes</a></li> <li><a href="/pyangbind">PyangBind Documentation</a></li> <li><a href="https://github.com/robshakir/pynms" target="_blank"><i class="icon icon-github"></i> GitHub</a></li> <!--<li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li>--> <!-- <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li>--> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div> <h1 class="post-title" itemprop="name headline"><span class="controlled-title">PyangBind: CLI Usage</span></h1> </div> <div class="zone"> <span class="naviitem"><a class="naviitem" href="/pyangbind/">Overview</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/getting_started">Getting Started</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/usage">Usage</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/generic_methods">Generic Methods</a></span> <span class="naviitem"><a class="naviitem" href="/errors">Errors</a></span> <span class="naviitem"><a class="naviitem" href="/serialisation">Serialisation</a></span> <span class="naviitem"><a class="naviitem" href="/xpath">XPATH</a></span> <span class="naviitem"><a class="naviitem" href="/extmethods">Extension Methods</a></span> <span class="naviitem"><a class="naviitem" href="/rpc">RPCs</a></span> <span class="naviitem"><a class="naviitem" href="/yang">YANG Mapping</a></span> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>PyangBind adds a number of command-line options to Pyang:</p> <ul> <li><a href="#output-options">Output options</a> - <code>-o</code>, <code>--split-class-dir</code></li> <li><a href="#xpathhelper">XPathHelper options</a> - <code>--use-xpath-helper</code></li> <li><a href="#extensions">Extensions options</a> - <code>--interesting-extension</code></li> <li><a href="#rpcs">RPC options</a> – <code>--build-rpcs</code></li> <li><a href="#extmethods">Extended Methods</a> – <code>--use-extmethods</code></li> <li><a href="#yangmods">YANG Module Arguments</a></li> </ul> <hr /> <h2 id="output-options-a-nameoutput-optionsa">Output Options <a name="output-options"></a></h2> <p>PyangBind has three output modes:</p> <ul> <li>A file for all generated classes: <ul> <li>Written to <code>stdout</code></li> <li>Written to a single .py file</li> </ul> </li> <li>A Python module hierarchy.</li> </ul> <hr /> <h3 id="stdout">stdout</h3> <p>When no options are specified, PyangBind will write a single file to <code>stdout</code>, this is considered to be self-contained and can be redirected to a particular location by the shell.</p> <hr /> <h3 id="o-filename">-o [filename]</h3> <p>When <code>-o &lt;filename&gt;</code> is specified (a standard Pyang option), then the single file output is redirected to the filename specified. Within this single file, to ensure that class names remain unique then the class naming used for all non-top-level classes is of the form <code>yc_&lt;lastcontainername&gt;_&lt;modulename&gt;__&lt;object path, replacing "/" with "_"&gt;</code>. Clearly, this results in relatively complex class names such as <code>yc_config_openconfig_bgp__bgp_global_config</code> corresponding to the <code>/bgp/global/config</code> container in the OpenConfig BGP module.</p> <hr /> <h3 id="split-class-dir-directory">–split-class-dir [directory]</h3> <p>When <code>--split-class-dir &lt;directory&gt;</code> is specified then PyangBind will create a Python module hierarchy in <code>directory</code>. This will result in each level of hierarchy in the YANG module becoming its own sub-module.</p> <p>For example, the OpenConfig BGP module has the following hierarchy:</p><pre><code>module: openconfig-bgp
   +--rw bgp!
      +--rw global
      |  +--rw config
      |  |  +--rw as           inet:as-number
      |  |  +--rw router-id?   inet:ipv4-address
      |  +--ro state
      |  |  +--ro as                inet:as-number
      |  |  +--ro router-id?        inet:ipv4-address
      |  |  +--ro total-paths?      uint32
      |  |  +--ro total-prefixes?   uint32
</code></pre><p>When <code>--split-class-dir openconfig</code> is specified, then the class corresponding to the <code>bgp</code> container will be output in a Python module named <code>openconfig</code>. This module can then be imported via:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span><span style="color:#080;font-weight:bold">from</span> <span style="color:#B44;font-weight:bold">openconfig</span> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">bgp</span>
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>ocbgp = bgp()
</pre></div> </div> </div> <p>At deeper levels of hierarchy a class is output within a sub-module of the same name, such that to import the BGP <code>global</code> container class, then the <code>global_</code> module is imported, with the <code>global_</code> class within it being instantiated:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span><span style="color:#080;font-weight:bold">from</span> <span style="color:#B44;font-weight:bold">openconfig.bgp</span> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">global_</span>    <span style="color:#777"># global is a reserved word</span>
<span class="line-numbers"><a href="#n2" name="n2">2</a></span><span style="color:#080;font-weight:bold">from</span> <span style="color:#B44;font-weight:bold">openconfig.bgp.global_</span> <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">config</span>
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>bgp_global = global_.global_()
<span class="line-numbers"><a href="#n5" name="n5">5</a></span>bgp_global_config = config.config()
</pre></div> </div> </div> <hr /> <h2 id="xpathhelper-options-a-namexpathhelpera">XPathHelper Options <a name="xpathhelper"></a></h2> <p>If <code>--use-xpath-helper</code> is <em>not</em> specified, then all XPATH references throughout the classes generated will act as strings - such that any element that relies in XPATH (<code>when</code>/<code>leaf-ref</code> statements etc.) will simply take on any value that they are set to.</p> <p>When<code> --use-xpath-helper</code> is specified, then references to the <code>path_helper</code> object that is supplied at the time of class instantiation will be passed to all of the classes children. This object is then used to provide lookup capabilities for XPATH expressions. This behaviour is further documented in (the XPathHelper documentation](xpathhelper.md).</p> <hr /> <h2 id="extension-options-a-nameextensionsa">Extension Options <a name="extensions"></a></h2> <p>When <code>--interesting-extension &lt;modulename&gt;</code> is specified then PyangBind will look for extensions from the module name provided that are included in the YANG module. These extensions are then placed in a dictionary that is accessible through each class’ <code>_extensions()</code> method.</p> <p>For example, with the following YANG:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>import example-extension { prefix &quot;egx&quot;; }
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>leaf description {
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>  egx:descr-flag &quot;d&quot;;
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>  egx:descr-order 100;
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>  type string;
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  description
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    &quot;A human-readable text description&quot;;
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>}
</pre></div> </div> </div> <p>If <code>--interesting-extension example-extension</code> is specified, then the <code>description</code> object’s <code>_extensions()</code> method will return a dictionary:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>&gt;&gt;&gt; print(cls.description._extensions())
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>{<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">example-extensions</span><span style="color:#710">'</span></span>: {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">descr-flag</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">d</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">descr-order</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">100</span><span style="color:#710">'</span></span>}}
</pre></div> </div> </div> <p>These extensions can then be consumed by the program manipulating the classes.</p> <hr /> <h2 id="rpc-options-a-namerpcsa">RPC Options <a name="rpcs"></a></h2> <p>By default, PyangBind will ignore all RPC definitions within a YANG file. When <code>--build-rpcs</code> is specified, then each RPC, with its corresponding <code>input</code> and <code>output</code> containers will be generated into a class which corresponds to <code>&lt;modulename&gt;_rpc</code> at the root of the data tree.</p> <p>See the <a href="rpc.md">RPC documentation</a> for more detail as to the usage of generated RPC classes.</p> <hr /> <h2 id="extended-methods-a-nameextmethodsa">Extended Methods <a name="extmethods"></a></h2> <p>When the <code>--use-extmethods</code> command-line option is specified, PyangBind will propagate the dictionary that is provided as the option <code>extmethods=</code> argument during class initialisation to the children objects. If this option is not specified, this option is always <code>False</code>.</p> <p>See the <a href="extmethods.md">Extension Methods</a> documentation for detail of this functionality.</p> <hr /> <h2 id="yang-module-arguments-a-nameyangmodsa">YANG Module Arguments <a name="yangmods"></a></h2> <p>As per Pyang - when using the PyangBind plugin, the YANG modules to be compiled are specified on the command line, along with <code>-p &lt;path&gt;</code> to specify where Pyang should look for other modules that are included. However, unlike Pyang, PyangBind needs to be able to resolve all base typedefs - in some cases this may involve specifying additional modules to be compiled if they included <code>identity</code> or <code>typedef</code> statements. In the case that a definition cannot be resolved, PyangBind will not generate bindings and will return a list of the known definitions at the time of the error. The current error language is not particularly user friendly - if PyangBind is unable to resolve a type definition or identity statement, please open a bug with the YANG modules being used such that this can be examined.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="https://github.com/robshakir" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://uk.linkedin.com/in/robjs" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->