<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Generic Methods Provided to PyangBind Classes</title> <meta name="description" content="PyangBind’s YANGDynClass function generates meta-classes around the class that is defined as the base_type/base when the class is generated. The wrapper that..."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://pynms.io/pyangbind/generic_methods"> <link rel="alternate" type="application/rss+xml" title="PyNMS" href="http://pynms.io/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Home</a></li> <li><a href="/about">About</a></li> <li><a href="/docs">Documentation Notes</a></li> <li><a href="/pyangbind">PyangBind Documentation</a></li> <li><a href="https://github.com/robshakir/pynms" target="_blank"><i class="icon icon-github"></i> GitHub</a></li> <!--<li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li>--> <!-- <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li>--> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div> <h1 class="post-title" itemprop="name headline"><span class="controlled-title">PyangBind: Generic Methods Provided to PyangBind Classes</span></h1> </div> <div class="zone"> <span class="naviitem"><a class="naviitem" href="/pyangbind/">Overview</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/getting_started">Getting Started</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/usage">Usage</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/generic_methods">Generic Methods</a></span> <span class="naviitem"><a class="naviitem" href="/errors">Errors</a></span> <span class="naviitem"><a class="naviitem" href="/serialisation">Serialisation</a></span> <span class="naviitem"><a class="naviitem" href="/xpath">XPATH</a></span> <span class="naviitem"><a class="naviitem" href="/extmethods">Extension Methods</a></span> <span class="naviitem"><a class="naviitem" href="/rpc">RPCs</a></span> <span class="naviitem"><a class="naviitem" href="/yang">YANG Mapping</a></span> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>PyangBind’s <code>YANGDynClass</code> function generates meta-classes around the class that is defined as the <code>base_type</code>/<code>base</code> when the class is generated. The wrapper that is provided gives a set of functions and variables that allow YANG-specific information to be stored alongside the value of the class.</p> <p>Some of these methods are generically useful when handling the classes, as well as internally to PyangBind.</p> <p>In general, methods are defined as <code>_&lt;methodname&gt;</code> such that clashes with the elements within YANG containers can be avoided - although for historical reasons, in some cases the <code>_</code> is omitted.</p> <hr /> <h2 id="contents">Contents</h2> <ul> <li><a href="#ydcmethods">YANGDynClass Methods</a> - generic to all PyangBind wrapped objects other than those corresponding to YANG modules.</li> <li><a href="#containermethods">YANG Container Methods</a> - methods defined for PyangBind objects corresponding to YANG <code>container</code> items.</li> <li><a href="#listmethods">YANG List Methods</a> - methods defined for PyangBind objects corresponding to YANG <code>list</code> items.</li> </ul> <hr /> <h2 id="methodsvariables-defined-in-yangdynclass-a-nameydcmethodsa">Methods/Variables Defined in YANGDynClass <a name="#ydcmethods"></a></h2> <h3 id="default"><code>default()</code></h3> <p>Where a YANG type has a default value specified, the default method returns this value. The actual class’ value is set to the null value of the base class (e.g., <code>unicode</code> objets return <code>''</code>, <code>int</code> objects return 0), whereas the default value is stored in <code>_default</code>. If there is no default defined, then <code>_default</code> is set to False.</p> <h3 id="changed"><code>_changed()</code></h3> <p>Returns <code>True</code> when the class (or a child of the class if it represents a container) has been set. This allows subsets of the data tree that have been manipulated to be retrieved as opposed to all elements.</p> <h3 id="yangname"><code>yang_name()</code></h3> <p>Returns the name of the data element as defined in the YANG module rather than the <code>safe_name</code> returned value.</p> <h3 id="addmetadata--metadata"><code>_add_metadata()</code> &amp; <code>_metadata</code></h3> <p>The <code>_metadata</code> element is a dictionary which can stores any meta-data that was provided as part of the data instance. For example, the Juniper example JSON instance for BGP global configuration may be akin to:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span><span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">config</span><span style="color:#710">&quot;</span></span> : {
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">@router-id</span><span style="color:#710">&quot;</span></span> : {
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>      <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inactive</span><span style="color:#710">&quot;</span></span> : true
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>   },
<span class="line-numbers"><a href="#n5" name="n5">5</a></span>   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">router-id</span><span style="color:#710">&quot;</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">10.10.10.10</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n6" name="n6">6</a></span>}
</pre></div> </div> </div> <p>In this case, the <code>router_id</code> member of the <code>config</code> class will have a dictionary of the form <code>{"inactive": True}</code> stored with it.</p> <p>The <code>_add_metadata()</code> method allows new metadata to be added. The arguments expected are a key, followed by a metadata value, e.g.:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>config.router_id._add_metadata(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inactive</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">True</span>)
</pre></div> </div> </div> <p>will add the metadata shown above.</p> <h3 id="registerpath--path"><code>_register_path()</code> &amp; <code>_path()</code></h3> <p>Both of these methods currently return the same data: a list defining the elements of the path to the data element in the tree. For example, the entry for <code>/bgp/neighbors/neighbor[peer-address='192.0.2.1']/config/peer-as</code> will return <code>['bgp', 'neighbors', 'neighbor[peer-address='192.0.2.1']', 'config', 'peer-as']</code>.</p> <h3 id="yangpath"><code>_yang_path()</code></h3> <p>Returns the path to the YANG object as a string.</p> <h3 id="namespace"><code>_namespace</code></h3> <p>Returns the namespace (from the <code>namespace</code> statement) of the YANG module that defined the element.</p> <h3 id="definingmodule"><code>_defining_module</code></h3> <p>Returns the module name from the <code>module</code> statement of the YANG module that defined the element. This is used in a number of cases within IETF JSON serialisation/deserialisation.</p> <h3 id="choice"><code>_choice</code></h3> <p>If the element is defined within a <code>choice</code> statement, then this value carries the name of the <code>case</code> that it is a part of. This is used to call <code>_unset_X</code> where X is the element’s <code>safe_name</code> when a member of another <code>case</code> is set (since two <code>case</code> elements of a choice cannot co-exist).</p> <h3 id="parent"><code>_parent</code></h3> <p>Returns a reference to the element’s parent class - for example, if one has a list entry at <code>/bgp/neighbors/neighbor[peer-address='2001:DB8::1']/config/peer-as</code> then <code>_parent</code> of the <code>peer-as</code> object refers to the <code>config</code> object, and the corresponding <code>_parent</code> of the <code>config</code> object refers to the list entry for the neighbor.</p> <p>This is generally useful in the cases where one has a <code>leafref</code> value that refers to the key of a list and the application requires the list entry itself (i.e., in this case one can do: <code>leafref_leaf._parent</code> to get to the list entry of a list).</p> <h3 id="iskeyval"><code>_is_keyval</code></h3> <p>Returns <code>True</code> if this value is the key of a list.</p> <hr /> <h2 id="yang-container-pybindbase-defined-methods-a-namecontainermethodsa">YANG Container (<code>PybindBase</code>) defined Methods <a name="containermethods"></a></h2> <h3 id="elements"><code>elements()</code></h3> <p>Returns a list of the names of the elements of the container. This can be used when iterating, although <code>for child in container</code> can also be used.</p> <h3 id="getfilterbool"><code>get(filter=&lt;bool&gt;)</code></h3> <p>Returns a nested set of dictionaries that represent the current container. The filter argument provides a means to get only those elements that have changed during the current manipulation of the data tree (including being deserialised from a data instance):</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777"># Setup of data omitted</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>&gt;&gt; <span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">pprint</span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>&gt;&gt; pp = pprint.PrettyPrinter(indent=<span style="color:#00D">4</span>)
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>&gt;&gt; pp.pprint(r.tables.get(filter=<span style="color:#069">True</span>))
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>{   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">AGGREGATE</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">config</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">AGGREGATE</span><span style="color:#710">'</span></span>},
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>                                  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">AGGREGATE</span><span style="color:#710">'</span></span>},
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>                 <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">BGP</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">config</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">BGP</span><span style="color:#710">'</span></span>},
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>                            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">BGP</span><span style="color:#710">'</span></span>},
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>                 <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">STATIC</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">config</span><span style="color:#710">'</span></span>: {   <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">STATIC</span><span style="color:#710">'</span></span>},
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>                               <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">table-name</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#E40">u</span><span style="color:#710">'</span><span style="color:#D20">STATIC</span><span style="color:#710">'</span></span>}}}
</pre></div> </div> </div> <p>This may be used as an alternative to serialising/deserialising instances especially for debugging. In general, the serialisation classes will use this format as a intermediary to be able to retrieve data from the classes.</p> <hr /> <h2 id="yang-list-methods-a-namelistmethodsa">YANG List Methods <a name="listmethods"></a></h2> <p>PyangBind provides two special methods for YANG <code>list</code> objects:</p> <h3 id="addkeyspec"><code>add(&lt;keyspec&gt;)</code></h3> <p>Adds a new entry to the list. In the case that the list is a keyed list - then the value returned is a reference to the newly created list entry. In the case that the list is not keyed, the value returned is the key value (a UUID) that has been defined internally by PyangBind.</p> <p>The key specification can be of three forms:<br /> * A value representing the key - in the case of a list with a single key, then the entire value is used as a key.<br /> * A space-separated string representing multiple keys. In this case, the key ordering is as specified in the <code>key</code> leaf in the YANG module, and the string is split at each space. For example, a list two with a key specification of <code>key "srcip index"</code> supplies with <code>.add("192.0.2.1 1")</code> would set <code>srcip=192.0.2.1</code> and <code>index=1</code>. The key values will cast the split string into the relevant type for storage in the corresponding list entry.<br /> * A set of keyword arguments for each key. For example, if the same list as above were called with <code>.add(index=1, srcip="192.0.2.1")</code> then the keyword arguments for each key would be extracted. In this case, order does not matter.</p> <h3 id="deletekeyspec"><code>delete(&lt;keyspec&gt;)</code></h3> <p>Removes the key value specified by <code>keyspec</code> from the list. The logic for the format of <code>keyspec</code> is the same as <code>add</code>.</p> <h3 id="newitem"><code>_new_item()</code></h3> <p>In some cases it is preferable to create a valid object outside of the context of it being added to the list (for example, in cases where there is some action performed around the <code>add()</code> call by the program consuming PyangBind’s classes). To this end, the <code>_new_item()</code> method (called as <code>yang_list._new_item())</code> returns an empty instance of a member of the list, which can be populated.</p> <h3 id="appendobject"><code>append(object)</code></h3> <p>Where an item has been created without being added to the list, it can be added using the <code>append()</code> function. The object supplied as the <code>obj</code> argument is used to extract the list key which is to be used for the item. As per a standard Python <code>list</code> item’s <code>append()</code> method, there is no return from this function.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="https://github.com/robshakir" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://uk.linkedin.com/in/robjs" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->