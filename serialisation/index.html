<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Serialisation and Deserialisation of YANG Modelled Data</title> <meta name="description" content="PyangBind provides a set of helper classes which allow data to be loaded from, or serialised to a loaded data format. At the time of writing, the supported f..."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://pynms.io/serialisation"> <link rel="alternate" type="application/rss+xml" title="PyNMS" href="http://pynms.io/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Home</a></li> <li><a href="/about">About</a></li> <li><a href="/docs">Documentation Notes</a></li> <li><a href="/pyangbind">PyangBind Documentation</a></li> <li><a href="https://github.com/robshakir/pynms" target="_blank"><i class="icon icon-github"></i> GitHub</a></li> <!--<li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li>--> <!-- <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li>--> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div> <h1 class="post-title" itemprop="name headline"><span class="controlled-title">PyangBind: Serialisation and Deserialisation of YANG Modelled Data</span></h1> </div> <div class="zone"> <span class="naviitem"><a class="naviitem" href="/pyangbind/">Overview</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/getting_started">Getting Started</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/usage">Usage</a></span> <span class="naviitem"><a class="naviitem" href="/pyangbind/generic_methods">Generic Methods</a></span> <span class="naviitem"><a class="naviitem" href="/errors">Errors</a></span> <span class="naviitem"><a class="naviitem" href="/serialisation">Serialisation</a></span> <span class="naviitem"><a class="naviitem" href="/xpath">XPATH</a></span> <span class="naviitem"><a class="naviitem" href="/extmethods">Extension Methods</a></span> <span class="naviitem"><a class="naviitem" href="/rpc">RPCs</a></span> <span class="naviitem"><a class="naviitem" href="/yang">YANG Mapping</a></span> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>PyangBind provides a set of helper classes which allow data to be loaded from, or serialised to a loaded data format. At the time of writing, the supported formats are:</p> <ul> <li>IETF JSON - defined in <code>draft-ietf-netmod-yang-json-08</code>.</li> <li>OpenConfig/PyangBind JSON - which does not currently have a published specification.</li> </ul> <p>In the future, it is expected that an XML serialisation module may be required, given the current bias of devices towards this serialisation format.</p> <hr /> <h2 id="contents">Contents</h2> <ul> <li><a href="#load-json-module">Loading from JSON - Entire Module</a> <ul> <li><a href="#load-functions">Load Functions</a> <ul> <li><a href="#json-loads"><code>loads</code> and <code>loads_ietf</code></a></li> <li><a href="#json-load"><code>load</code> and <code>load_ietf</code></a></li> </ul> </li> <li><a href="#example-load">Example Loading (Deserialisation)</a> <ul> <li><a href="#example-load-oc">Loading OpenConfig/PyangBind JSON-encoded Data</a></li> <li><a href="#example-load-ietf">Loading IETF-JSON encoded Data</a></li> </ul> </li> </ul> </li> <li><a href="#load-json-existing">Loading Data into an Existing Instance</a> <ul> <li><a href="#load-json-existing-example">Example of Loading to Existing Instances</a></li> </ul> </li> <li><a href="#serialising-json">Serialising Data into JSON</a> <ul> <li><a href="#example-serialisation">Example Serialisation</a></li> </ul> </li> <li><a href="#example-code">Example Code</a></li> </ul> <hr /> <h2 id="loading-from-json---entire-module-a-nameload-json-modulea">Loading from JSON - Entire Module <a name="load-json-module"></a></h2> <p>The module <code>pyangbind.lib.pyangbindJSON</code> provides a wrapper around the encoder and decoder classes that are defined in <code>pyangbind.lib.serialise</code>. These methods are heavily biased towards loading an entire module into a new instance of the data tree.</p> <p>The functions <code>loads</code>, <code>load</code>, <code>loads_ietf</code> and <code>load_ietf</code> are analagous to the Python <code>json</code> module’s functions. The <code>loads.*</code> functions load from a string which is expected to be valid JSON, whereas the <code>load.*</code> functions load from a file name that is specified to the modules.</p> <hr /> <h3 id="load-functions-a-nameload-json-modulea">Load Functions <a name="load-json-module"></a></h3> <h4 id="loadsdata-pythonmodule-classname-and-loadsietfdata-pythonmodule-classname-a-namejson-loadsa"><code>loads(data, python_module, class_name)</code> and <code>loads_ietf(data, python_module, class_name)</code> <a name="json-loads"></a></h4> <p>The arguments to the <code>loads</code> functions are expected to be:<br /> * <code>data</code> - a JSON-encoded string that can be loaded using Python’s <code>json.load()</code> function.<br /> * <code>python_module</code> - the module within which the class that is to be instantiated is defined. In the case that <code>-o &lt;filename&gt;</code> is used, then this is <code>filename</code> as this code is a Python module that can be loaded with <code>import</code>. In the case that <code>--split-class-dir &lt;directory&gt;</code> has been used then it is <code>directory</code>.<br /> * <code>class_name</code> - the name of the Python class that is found within <code>module</code>. This is the safe name (i.e., Python-safe - using no reserved Python keywords and substituting hyphens for underscores) of the YANG module that has been compiled - e.g., <code>openconfig_bgp</code>.</p> <p>These functions return a PyangBind class instance with the data from <code>data</code> loaded into it.</p> <h4 id="loadfilename-pythonmodule-classname-and-loadietffilename-pythonmodule-classname-a-namejson-loada"><code>load(filename, python_module, class_name)</code> and <code>load_ietf(filename, python_module, class_name)</code> <a name="json-load"></a></h4> <p>The arguments to the <code>load</code> and <code>load_ietf</code> functions are identitical to those of the <code>loads</code> functions, other than the <code>filename</code> argument is a path to a file that can be loaded using <code>open(filename, 'r')</code>.</p> <p>These functions return a PyangBind class instance with the data from <code>filename</code> loaded.</p> <hr /> <h3 id="example-loading-deserialisation-a-nameexample-loada">Example Loading (Deserialisation) <a name="example-load"></a></h3> <p>With a simple module - such as the following:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>module simple_serialise {
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>    yang-version &quot;1&quot;;
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>    namespace &quot;http://rob.sh/yang/test/ss&quot;;
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>    prefix &quot;ss&quot;;
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>    container a-container {
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>        leaf a-value {
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>            type int8;
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        }
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>    }
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>    list a-list {
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>        key &quot;the-key&quot;;
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>        leaf the-key {
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>            type string;
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>        }
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>    }
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>}
</pre></div> </div> </div> <p>And bindings generated using:</p><pre><code>$ pyang --plugindir $PYBINDPLUGIN -f pybind -o sbindings.py simple_serialise.yang
</code></pre><hr /> <h4 id="loading-openconfigpyangbind-json-encoded-data-a-nameexample-load-oca">Loading OpenConfig/PyangBind JSON-encoded Data <a name="example-load-oc"></a></h4> <p>An example instance of data for the above module encoded as PyangBind JSON looks like the following:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>{
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>    <span style="color:#606"><span style="color:#404">&quot;</span><span>a-container</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>a-value</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">8</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>    },
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>    <span style="color:#606"><span style="color:#404">&quot;</span><span>a-list</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>entry-one</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>            <span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-one</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>        },
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>entry-two</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>            <span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-two</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        }
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>    }
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>}
</pre></div> </div> </div> <p>To load this, using <code>load</code> and <code>loads</code> the following code can be used:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777">#!/usr/bin/env python</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">pprint</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">pyangbind.lib.pybindJSON</span> <span style="color:#080;font-weight:bold">as</span> pbJ
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">sbindings</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>pp = pprint.PrettyPrinter(indent=<span style="color:#00D">4</span>)
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>loaded_object = pbJ.load(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">json/simple-instance.json</span><span style="color:#710">&quot;</span></span>, sbindings, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">simple_serialise</span><span style="color:#710">&quot;</span></span>)
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>pp.pprint(loaded_object.get(filter=<span style="color:#069">True</span>))
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>string_to_load = <span style="color:#369;font-weight:bold">open</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">json/simple-instance.json</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">r</span><span style="color:#710">'</span></span>).read().replace(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#b0b">\n</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>)
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>loaded_object_two = pbJ.loads(string_to_load, sbindings, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">simple_serialise</span><span style="color:#710">&quot;</span></span>)
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>pp.pprint(loaded_object_two.get(filter=<span style="color:#069">True</span>))
</pre></div> </div> </div> <p>In both cases, the <code>python_module</code> name used is the name of the bindings file generated (<code>sbindings</code>) and the modulename is as specified in the YANG module (i.e., <code>simple_serialise</code>).</p> <p>Both loading methods will return the same output:</p> <p><code>python { 'a-container': { 'a-value': 8}, 'a-list': { u'entry-one': { 'the-key': u'entry-one'}, u'entry-two': { 'the-key': u'entry-two'}}} </code>`</p> <hr /> <h4 id="loading-ietf-json-encoded-data-a-nameexample-load-ietfa">Loading IETF JSON-encoded Data <a name="example-load-ietf"></a></h4> <p>Loading IETF encoded data is almost identical, other than using the <code>loads_ietf</code> and <code>load_ietf</code> functions in place of <code>loads</code> and <code>load</code> respectively.</p> <p>The corresponding example IETF-encoded JSON object for the above data is:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>{
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>    <span style="color:#606"><span style="color:#404">&quot;</span><span>simple_serialise:a-container</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>a-value</span><span style="color:#404">&quot;</span></span>: <span style="color:#00D">8</span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>    },
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>    <span style="color:#606"><span style="color:#404">&quot;</span><span>simple_serialise:a-list</span><span style="color:#404">&quot;</span></span>: [
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>        {<span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-one</span><span style="color:#710">&quot;</span></span>},
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>        {<span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-two</span><span style="color:#710">&quot;</span></span>}
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>    ]
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>}
</pre></div> </div> </div> <p>This can be loaded in the same way using the following Python:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777"># Load an instance from an IETF-JSON file</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>loaded_ietf_obj = pbJ.load_ietf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">simple-instance-ietf.json</span><span style="color:#710">&quot;</span></span>, sbindings,
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>                                  <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">simple_serialise</span><span style="color:#710">&quot;</span></span>)
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>pp.pprint(loaded_ietf_obj.get(filter=<span style="color:#069">True</span>))
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span><span style="color:#777"># Load an instance from an IETF-JSON string</span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>string_to_load = <span style="color:#369;font-weight:bold">open</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">json/simple-instance-ietf.json</span><span style="color:#710">'</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">r</span><span style="color:#710">'</span></span>).read().replace(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#b0b">\n</span><span style="color:#710">'</span></span>,
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>                                                                         <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>)
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>loaded_ietf_obj_two = pbJ.loads_ietf(string_to_load, sbindings,
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>                                                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">simple_serialise</span><span style="color:#710">&quot;</span></span>)
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>pp.pprint(loaded_ietf_obj_two.get(filter=<span style="color:#069">True</span>))
</pre></div> </div> </div> <p>Again, the data loaded is idential to that shown above.</p> <hr /> <h2 id="loading-data-into-an-existing-instance-a-nameload-json-existinga">Loading Data into an Existing Instance <a name="load-json-existing"></a></h2> <p>In a number of cases, it is desirable to load data from a serialised JSON input into an existing set of PyangBind classes - such as when accepting input from an external API. Doing this requires direct access of the <code>pyangbind.lib.serialise</code> classes, rather than the <code>pyangbind.lib.pybindJSON</code> helper functions. The relevant functions are those within <code>pybindJSONDecoder</code> - particularly <code>load_ietf_json</code> and <code>load_json</code>.</p> <p>In order to use these functions (which are generally directly-called by the corresponding <code>pyangbind.lib.pybindJSON</code> functions - then there is a requirement to specify an already existing object, and skip the class instantiation stage of the loading functions.</p> <p>When calling the load functions, the following format is expected to load into an existing object:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>load_json(input_data, <span style="color:#069">None</span>, <span style="color:#069">None</span>, obj=existing_object, path_helper=path_helper,
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>                extmethods=extmethods, overwrite=overwrite):
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>load_ietf_json(input_data, <span style="color:#069">None</span>, <span style="color:#069">None</span>, obj=existing_object, path_helper=path_helper,
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>                                        extmethods=extmethods, overwrite=overwrite)
</pre></div> </div> </div> <p>Where:<br /> * <code>input_data</code> is a iterable object that corresponds to loaded JSON data.<br /> * <code>existing_object</code> is the object that should be loaded into - i.e., an instantiated set of PyangBind classes.<br /> * <code>path_helper</code>, <code>extmethods</code> - are the corresponding XPathHelper and extension methods that are to be used if required. In the case that these do not differ from the parent, they will be inherited.<br /> * <code>overwrite</code> determines whether the existing instance’s data should be overwritten by the loaded data.</p> <hr /> <h4 id="example-of-loading-to-existing-instances-a-nameload-json-existing-examplea">Example of Loading to Existing Instances <a name="load-json-existing-example"></a></h4> <p>Using the same module as above, with the loaded instance in question (defining <code>/a-list[the-key='entry-one']</code> and <code>/a-list[the-key='entry-two']</code> then data can be loaded using the following <code>load_json</code> call:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>data_to_load = json.load(<span style="color:#369;font-weight:bold">open</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">json/simple-instance-additional.json</span><span style="color:#710">'</span></span>,<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">r</span><span style="color:#710">'</span></span>))
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>pybindJSONDecoder.load_json(data_to_load, <span style="color:#069">None</span>, <span style="color:#069">None</span>, obj=existing_instance)
</pre></div> </div> </div> <p>The <code>existing_instance</code> object is modified in-place, and hence the list acquires the additional <code>entry-three</code> data defined in the <code>simple-instance-additional.json</code> file:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>pp.pprint(existing_instance.a_list.keys())
<span class="line-numbers"><a href="#n2" name="n2">2</a></span><span style="color:#777"># Outputs:</span>
<span class="line-numbers"><a href="#n3" name="n3">3</a></span><span style="color:#777"># [u'entry-two', u'entry-three', u'entry-one']</span>
</pre></div> </div> </div> <hr /> <h2 id="serialising-data-into-json-a-nameserialising-jsona">Serialising Data into JSON <a name="serialising-json"></a></h2> <p>In order to serialise a PyangBind class instance into JSON, the <code>dump</code>, <code>dumps</code> functions defined in <code>pyangbind.lib.pybindJSON</code> are used. These functions take a <code>mode</code> keyword argument which determines whether they dump IETF-specified JSON or PyangBind JSON.</p> <p><code> dump(obj, filename, indent=&lt;int&gt;, filter=&lt;bool&gt;, skip_subtrees=&lt;list&gt;, mode="default") </code></p> <ul> <li><code>obj</code> - which is a PyangBind class instance that is to be dumped. It is expected to havea <code>get</code> method, hence be a list or a container.</li> <li><code>filename</code> - the file to which the JSON should be written.</li> <li><code>indent</code> - the number of spaces to use to indent the JSON.</li> <li><code>filter</code> - analagous to the <code>filter</code> argument to a PyangBind class’ <code>get</code> method (see the documentation relating to generic methods), which determines whether the entire tree, or just the changed elements are to be dumped.</li> <li><code>skip_subtrees</code> - a list of paths (absolute rather than relative) that should be pruned from the output JSON. This is useful if multiple output files are used to save data instances.</li> <li><code>mode</code> - a string specifying the JSON encoding to be output – currently either “default” or “ietf”.</li> </ul> <p><code> dumps(obj, indent=4, filter=True, skip_subtrees=[], select=False, mode="default") </code><br /> * The <code>obj</code>, <code>indent</code>, <code>filter</code>, <code>skip_subtrees</code> and <code>mode</code> arguments of dumps are as per <code>dump</code>.<br /> * <code>select</code> - when provided is expected to be a dictionary of the form <code>{ "element_name": value }</code>. When this is specified only elements where <code>obj.element_name == value</code> are output. This is useful when using query parameters to select subsets of an object, or list.</p> <hr /> <h3 id="example-serialisation-a-nameexample-serialisationa">Example Serialisation <a name="example-serialisation"></a></h3> <p>In order to serialise an instance of the <code>simple_serialise</code> module used above - the following call is used:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>pyangbindJSON.dumps(existing_instance, filter=<span style="color:#069">True</span>)
</pre></div> </div> </div> <p>This outputs the entire module as JSON:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>{
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>    <span style="color:#606"><span style="color:#404">&quot;</span><span>a-list</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>entry-two</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>            <span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-two</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>        }, 
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>entry-three</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>            <span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-three</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>        }, 
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>entry-one</span><span style="color:#404">&quot;</span></span>: {
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>            <span style="color:#606"><span style="color:#404">&quot;</span><span>the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-one</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>        }
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>    }
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>}
</pre></div> </div> </div> <p>The JSON format can be switched to IETF-encoded JSON by using the <code>mode="ietf"</code> argument to dumps.</p> <p>To select an entry from the list where the <code>the-key</code> leaf is equal to “entry-one” (although this is a gratiutous example), the <code>select</code> dictionary can be used:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>pbJ.dumps(existing_instance.a_list, select={<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">the-key</span><span style="color:#710">'</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">entry-one</span><span style="color:#710">'</span></span>}, mode=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ietf</span><span style="color:#710">&quot;</span></span>)
</pre></div> </div> </div> <p>This outputs only the <code>entry-one</code> output of the list being shown:</p> <div class="highlighter-coderay"><div class="CodeRay"> <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>[
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>    {
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>        <span style="color:#606"><span style="color:#404">&quot;</span><span>simple_serialise:the-key</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entry-one</span><span style="color:#710">&quot;</span></span>
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>    }
<span class="line-numbers"><a href="#n5" name="n5">5</a></span>]
</pre></div> </div> </div> <hr /> <h2 id="example-code-a-nameexample-codea">Example Code <a name="example-code"></a></h2> <p>The example used throughout this document is included under <code>docs/example/simple-serialise</code>.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="https://github.com/robshakir" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://uk.linkedin.com/in/robjs" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/robshakir" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->